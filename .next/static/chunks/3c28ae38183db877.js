(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,61238,t=>{"use strict";let e=t.i(47167).default.env.NEXT_PUBLIC_API_URL||"http://localhost:8080/api/v1";class s extends Error{code;status;details;constructor(t,e,s,n){super(s),this.name="ApiError",this.status=t,this.code=e,this.details=n}}let n=null;function a(t){n=t}let o=!1,i=null;async function r(){return o&&i?i:(o=!0,i=(async()=>{try{let t=await fetch(`${e}/admin/auth/refresh`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(!t.ok)return n=null,null;let s=(await t.json()).data.accessToken;return n=s,s}catch{return n=null,null}finally{o=!1,i=null}})())}async function u(t,a={},o=!0){let i={"Content-Type":"application/json",...a.headers},l=n;l&&(i.Authorization=`Bearer ${l}`),console.log(`[API Request] ${a.method||"GET"} ${t}`);let c=await fetch(`${e}${t}`,{...a,headers:i,credentials:"include"});if(console.log(`[API Response] ${a.method||"GET"} ${t} -> ${c.status}`),401===c.status&&o){if(await r())return u(t,a,!1);n=null}let d=await c.json().catch(()=>null);if(!c.ok)throw new s(c.status,d?.error?.code||"UNKNOWN_ERROR",d?.error?.message||"An unexpected error occurred",d?.error?.details);return d}function l(t){return u(t,{method:"GET"})}function c(t,e){return u(t,{method:"POST",body:e?JSON.stringify(e):void 0})}function d(t,e){return u(t,{method:"PUT",body:e?JSON.stringify(e):void 0})}function h(t){return u(t,{method:"DELETE"})}t.s(["ApiError",()=>s,"del",()=>h,"get",()=>l,"post",()=>c,"put",()=>d,"setAccessToken",()=>a])},18566,(t,e,s)=>{e.exports=t.r(76562)},57951,t=>{"use strict";var e=t.i(43476),s=t.i(71645),n=t.i(18566),a=t.i(61238);let o=(0,s.createContext)(void 0);function i({children:t}){let i=(0,n.useRouter)(),[r,u]=(0,s.useState)({user:null,isAuthenticated:!1,isLoading:!0}),l=(0,s.useCallback)(async()=>{try{let t=await (0,a.post)("/admin/auth/refresh");(0,a.setAccessToken)(t.data.accessToken);let e=await (0,a.get)("/admin/auth/me");u({user:e.data,isAuthenticated:!0,isLoading:!1})}catch{(0,a.setAccessToken)(null),u({user:null,isAuthenticated:!1,isLoading:!1})}},[]);(0,s.useEffect)(()=>{l()},[l]);let c=(0,s.useCallback)(async(t,e)=>{let{accessToken:s,user:n}=(await (0,a.post)("/admin/auth/login",{email:t,password:e})).data;(0,a.setAccessToken)(s),u({user:n,isAuthenticated:!0,isLoading:!1}),i.push("/dashboard")},[i]),d=(0,s.useCallback)(async()=>{try{await (0,a.post)("/admin/auth/logout")}catch(t){t instanceof a.ApiError&&console.warn("Logout API call failed:",t.message)}finally{(0,a.setAccessToken)(null),u({user:null,isAuthenticated:!1,isLoading:!1}),i.push("/login")}},[i]);return(0,e.jsx)(o.Provider,{value:{...r,login:c,logout:d},children:t})}function r(){let t=(0,s.useContext)(o);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}t.s(["AuthProvider",()=>i,"useAuth",()=>r],57951)}]);